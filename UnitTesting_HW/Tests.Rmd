---
title: "Tests"
author: "Emily Arsenault"
date: "March 28, 2018"
output: pdf_document
---

```{r, echo=T}
source("base_sig.R")
```

## Tests for base_sig

Test that it can find the correct primary producer signature mean for site "WIN1"

```{r base_sig_test_1, echo=T}
sitetest <- "WIN1"
frac <- 3.4
h <- base_sig(muss, frac)
if(round(h[sitetest,2], digits = 3)==10.687)
{
  print("passed")
} else
{
  print("failed")
}
```

## Tests for tp_calc

Test to make sure that no fish trophic position is less than 2 or greater than 5 (if it is, it was calculated incorrectly)

```{r tp_calc_test_1, echo=T}
fish <- read.csv("fish.csv")
h <- tp_calc(fish, frac=3.4)
if (h[tp>2 & tp<5])
{
  print("passed")
} else
{
  print("failed")
}
```

Tests that it calculates tp correctly for one specific data point

```{r tp_calc_test_2, echo=T}
fish <- read.csv("fish.csv")
h <- tp_calc(fish, frac=3.4)
if (round(h[[id==1001]][tp==3.53], digits=2))
{
  print("passed")
} else
{
  print("failed")
}
```
  
## Tests for fcl_calc

Test to make sure an FCL value was calculated for all 12 sites in the dataset

```{r fcl_calc_test_1, echo=T}
h <- fcl_calc(fish, frac)
if (nrow(h)==12)
{
  print("passed")
} else
{
  print("failed")
}
```

Test to make sure that FCL was calculated correctly for site 1a

```{r fcl_calc_test_2, echo=T}
fish <- read.csv("fish.csv")
h <- fcl_calc(fish, frac)
if (round(h[[site=="1a"]][maxtp==4.20], digits = 2))
{
  print("passed")
} else
{
  print("failed")
}
```