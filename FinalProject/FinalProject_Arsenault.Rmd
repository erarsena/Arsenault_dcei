---
title: Effect of hydrogeomorphology on trophic complexity of the Upper Mississippi River (USA)
author: E. R. Arsenault, J. H. Thorp, M. D. Delong, and R. E. Bowes
date: 03 May 2018
output: pdf_document
fontsize: 12pt
bibliography: datacarpentry.bib
csl: ecology.csl
---

Note: I have simplified my project a bit to make it more feasible for the timeframe. While the original sampling design mentioned in my proposal included sampling sub-habitats within each of 4 major sites (MMR, SCR, PEP, and WIN), I am ignoring those and just focusing on differences among the 4 sites themselves.

<!--Chunk for installing and loading necessary packages-->
```{r checkpoint, echo=F, include=F, warning=F}

#Dependencies: need internet connection to run checkpoint
#Note: .checkpoint folder should have been added to my GitHub repo, so I hope it runs with less trouble this time!

#installing packages (if not already installed) and loading libraries
projpacks <-  c("checkpoint", "plyr", "mapdata", "RColorBrewer", "grDevices", "maps", "maptools", "ggplot2", "SIBER") #packages used in this project
projinst <- projpacks %in% installed.packages() #finding necessary packages within packages already installed

#installing packages not already installed
if(length(projpacks[!projinst]) > 0) 
{
  install.packages(projpacks[!projinst])
}

#loading all packages (require)
lapply(projpacks, require, character.only = TRUE)

#creating a .checkpoint folder in directory (unless it already exists)
if (!dir.exists("./.checkpoint/"))
{
  dir.create("./.checkpoint/")
}
date <- "2018-04-01"
checkpoint(date,checkpointLocation = "./")
checkpoint(date)

#Outputs: loaded packages for all functions in file, checkpoint for package reproducibility
```

<!--Chunk for sourcing external scripts-->
```{r, echo=F}

#Dependencies: external scripts, each with 1 function

source("base_sig.R")
source("tp_calc.R")
source("fcl_calc.R")
source("gen_col.R")
source("plot_web.R")
source("layman_calc.R")

#Output: available functions base_sig(), tp_calc(), fcl_calc(), gen_col(), plot_web(), and layman_calc()
```

<!--Chunk for importing the data-->
```{r import, echo=F}

#Dependencies: csv files "muss.csv" (primary consumer data) and "fish.csv" (fish food web data)

muss <- read.csv("muss.csv", header = T) #primary producer signature data (mussels)
fish <- read.csv("fish.csv", header = T) #fish consumer richness, length, mass, and isotope data

mussdf <- base_sig(muss = muss, frac = 3.4)
tpdf <- tp_calc(mussdf, fish = fish, frac = 3.4)
fcldf <- fcl_calc(tpdf)

#Output: muss and fish dataframes (CSV files) and mussdf tpdf, and fcldf dataframes (outputs from functions), data needed for all analyses in this file
```

## **Abstract**

Historically, many studies in river ecology have focused on investigating processes in great detail over small spatial scales. More recently, studies have begun to suggest the importance of large-scale studies in river ecology. In particular, viewing rivers through their unique hydrogeomorphological characteristics provides a unique perspective on analyzing habitat complexity and its effect on biotic interactions like food webs. Here, we examined trophic relationships among fish at sites of varying hydrogeomorphic complexity along the Upper Mississippi River. [MAJOR FINDING 1] [MAJOR FINDING 2] The results of this study suggest that hydrogeomorphic complexity is a driver of food chain complexity in rivers, a finding that has important implications for river conservation and management as we strive to promote complexity in this important river ecosystem.

## **Introduction**

Recent developments in ecology suggest that the understanding of ecological processes may benefit from an expanded focus at the macrosystem scale, especially in the context of global climate change and species invasions [@Williams2013; @Grabowski2016]. Past studies in river ecology have focused primarily on microhabitats and relatively small stream reaches, guided by conceptual models often over-emphasizing the longitudinal gradient of rivers as a predictor of food web interactions (e.g., River Continuum Concept, [@Vannote1980]). In more recent attempts to increase spatial scale, researchers have employed meta-analyses and extrapolation techniques; however, these types of studies may not be adequate in themselves for understanding natural systems [@Hilderbrand2004].  

The Riverine Ecosystem Synthesis (RES), proposed by @Thorp2006, offered a new framework for understanding river ecosystems by “portray[ing] rivers as downstream arrays of large hydrogeomorphic patches (e.g., constricted, braided and floodplain channel areas) formed by catchment geomorphology and climate.” This model integrated concepts from the models before it, but refuted the River Continuum Concept [@Vannote1980] by suggesting a discontinuous nature of river networks in contrast to the predictable and continuous gradient originally proposed. The theoretical foundation of RES was based on concepts from hierarchical patch dynamics [@Wu1995; @Townsend1989; @Poole2002], hydrogeomorphology [@Thoms2002], and the multiple dimensionality of rivers [@Ward1989].

Recently, the RES concepts of hydrogeomorphological patches (FPZs) and the hierarchical nature of a landscape have been directly tied to ecological hypotheses and studies of the river macrosystem [@Thorp2014; @McCluney2014]. An ecological macrosystem can be defined as “a hierarchically organized, integrated terrestrial, inland aquatic and/or marine ecological unit of large spatial extent (c. $10^{2}$-$10^{6}$ $km^{2}$ or more depending on the types and sizes of ecosystems present) whose temporal interactions within the unit and with regional through global processes are especially significant over periods of decades to millennia” [@Thorp2014]. This concept can be applied to many different systems, but in river ecology, the river macrosystem can be defined as a network of interacting riverscape and floodscape patches. Riverscapes include all currently active main channels, side channels, and backwaters of rivers, while floodscapes consist of the normally dry floodplains, floodplain lakes, wetlands, and oxbow lakes [@Thorp2006].  

Here, we conduct a large-scale food web study to better understand the effects of hydrogeomorphology on ecosystem function within a macrosystem framework. In particular, we investigated the effect of river hydrogeomorphic complexity on fish food web complexity in four unique FPZs of the Upper Mississippi River to determine whether or not there was an FPZ effect on fish food web complexity. We predicted that fish food web complexity, as quantified using several common metrics, would increase with increasing habitat complexity at an FPZ site.

## **Methods**

### *Study Sites*

This study was conducted between the months of May and July 2010 in the Upper Mississippi River (UMR) watershed. Sites were located along a large geographic gradient and represented a variety of hydrogeomorphic characteristics. Four major areas along the UMR were sampled; upstream to downstream, we sampled a tributary (St. Croix River), a reservoir (Lake Pepin), a naturally anastomosing area (near Winona, MN), and a main channel site (above the confluence of the UMR and the Illinois River; Figure 1).

<!--Chunk for making a map of the study sites-->
```{r map, echo=F, fig.height=8, fig.width=4, warning=F, fig.cap="Study sites located along four different hydrogeomorphic zones of the Mississippi River"}

#Dependencies: csv file with lat and long coordinates for each site

latuppmiss <- c(45.5675, 44.50, 43.8442, 39.4408)
lonuppmiss <- c(-92.8647, -92.30, -91.2923, -91.0259)
sites <- c("SCR", "PEP", "WIN", "MMR")

uppmissdf <- as.data.frame(c(latuppmiss, lonuppmiss, sites))
uppmiss_map <- map(database = "state", region = c("minnesota", "wisconsin", "missouri", "iowa", "illinois"), 
                   col=("gray90"), fill=TRUE, mar = c(0, 0, 1, 0))
points(lonuppmiss, latuppmiss, pch=16, col='black', cex=1)
with(uppmissdf, text(lonuppmiss-.55, latuppmiss, cex=0.7, labels=sites))
box()
map.scale(ratio = FALSE, metric = FALSE)

#Output: map of Upper Mississippi River study sites (uppmiss_map)
```

### *Quantification of Site Complexity*

Hydrogeomorphic measurements were taken at transects placed at 500 m intervals along a 10 km reach located within the sampling area for each of the four UMR sites. We measured the wetted width, or the linear distance between banks at current water level, at each transect. We also determined the number of channels and islands that were intersected by each transect, as well as the sinuosity of each reach. A combined sum of these 4 measurements were used to quantify channel complexity. Ranks for these variables were then summed to provide a single measure of hydrogeomorphic complexity for each site.

### *Fish and Mussel Collection*

Suspension-feeding mussels were hand-collected in shallow areas of each site. A representative fish community sample was collected from each 10-km site reach using boat electrofishing. Fishes and mussels were identified to species and classified into functional feeding groups based on regional fisheries manuals [@Etnier1993; @Pflieger1997]. We released all native mussels after the sampling a small amount of protenaceous periostracum, but invasive zebra mussels were collected whole and sacraficed. Small fish were collected whole, but larger fish were released after a small muscle plug was collected non-lethally from the dorsal tissue. 

### *Stable Isotope Analysis*

Tissues from all collected fishes and mussels were used for bulk-tissue stable isotope analysis of carbon and nitrogen ($\delta^{13}C$ and $\delta^{15}N$). All collected tissues were rinsed, dried in an oven for 48 hr at 60&deg;C , and homogenized into a fine powder using a Wig-L-Bug &reg; Mixer-Amalgamator. Prepared samples were held in a dessicator until submitted to the W. M. Keck Paleoenvironmental and Environmental Stable Isotope Laboratory (University of Kansas, Lawrence, KS, USA) for bulk-tissue stable isotope analysis of carbon and nitrogen. Isotope data for each sample included  $\delta^{13}C$ and $\delta^{15}N$ signatures, which were determined by the relative difference in isotope ratio between each sample and a known standard (Vienna Pee Dee Belemnite for C or atmospheric nitrogen for N) using the formula: $$\delta X=((Rsample-Rstandard)-1)*1000$$ where X is either $^{13}C$ or $^{15}N$ and the corresponding isotopic ratio (R) is either $^{13}C/^{12}C$ or $^{15}N/^{14}N$. All isotopic signature data is represented using per mille (&permil;) notation. 

### *Statistical Analysis*

All statistical analyses were conducted in R version 3.4.1 [@R2014]. Consumer (fish) trophic position was calculated by the formula: $$Trophic Position = [(\delta^{15}N consumer - \delta^{15}N herbivore)/3.4]+1]$$ where mean primary producer signatures were calculated using herbivore (mussel) signatures collected from each Mississippi River site. Food chain length was defined as the maximum trophic position for each site. In addition, we calculated six Layman's metrics using the SIBER package in R [@SIBER]: $\delta^{15}n$ range, $\delta^{13}C$ range, total area of the convex hull for each site, mean distance to centroid, mean nearest neighbor distance (NND), and the standard deviation of the NND, as detailed in @Layman2007. The fish food web of the Upper Mississippi River was represented using an isotope biplot of $\delta^{13}C$ and $\delta^{15}N$ signature values. 

## **Results**

Average hydrogeomorphic complexity varied among sites. From upstream to downstream, the average hydrogeomorphic complexity scores for each site were: 2.53 for SCR (headwaters), 4.43 for PEP (reservoir), 6.01 for WIN (anastomosing area), and 3.51 for MMR (main channel). 

In total, `r nrow(na.omit(tpdf))` fish representing `r nrow(levels(tpdf$species))` were collected from `r nrow(levels(tpdf$site))` sites `r levels(tpdf$site)` for bulk-tissue stable isotope analysis (see Supplemental Materials for more details). Mean trophic position for all sites along the Upper Mississippi was `r round(mean(tpdf$tp), digits = 2)`. Food chain length ranged from `r round(min(fcldf$fcl), digits=2)` at `r fcldf$site[fcldf$fcl==min(fcldf$fcl)]` to `r round(max(fcldf$fcl), digits=2)` at `r fcldf$site[fcldf$fcl==max(fcldf$fcl)]`. 

There were differences in food web structure among sites (Figure 2). At the headwaters of the Mississippi River at site SCR, we collected __ species, and the . The artificial reservoir, site PEP, _____. Further downstream, site WIN, a naturally anastomosing section of the UMR ____. Finally, MMR, the site furthest downstream along the main channel of the UMR ___.

<!--Chunk for making isotope plot by site-->
```{r siteplot, echo=F, results="hide", fig.cap="Biplot of d13C and d15N bulk tissue isotope signatures for fish collected in four FPZs of the Mississippi River (n=514). Points are colored according to site FPZ, with MMR in red, PEP in blue, SCR in green, and WIN in black."}

#Dependencies: plot_web function, data frame generated by tp_calc function

plot_web(tpdf)

#Output: plot with x=d13C and y=d15N for fish collected in four different zones of the Mississippi River
```

<!--Chunk for generating table of Layman's metrics-->
```{r layman, echo=F, warning=F}

#Dependencies:

layman_calc(tpdf)

#Output:
```

<!--Chunk for correlation plot of hydrogeomorphic complexity and food web complexity-->
```{r complexity, echo=F}

#Dependencies:

hgmcomplex <- c(3.51, 4.43, 2.53, 6.01) #in order of: MMR, PEP, SCR, WIN

laydf <- layman_calc(tpdf)

#Output:
```

## **Discussion**

Another plug for studying rivers at a large scale

Hydrogeomorphic complexity
The complexity value for Lake Pepin site may have been artificially high because of its very large wetted width as a reservoir.

Food web complexity relationship with hydrogeomorphic complexity?

## **Author Contributions**

J. H. T. and M. D. D. formulated the question and collected all field data. R. E. B. prepared and processed the samples. E. R. A. conducted statistical analyses and drafted the manuscript.

## **Supplemental Materials**

See supplement for abundance information for each species of mussel and fish collected along all sites of the Upper Mississippi River.

## **References**