#' tp_calc
#'
#' Takes output from base_sig to calculate the trophic position for each fish (row) in dataframe
#
#' @param base A data frame generated by function base_sig
#' @param fish A data frame with isotope data arranged by species and site
#' @param frac Trophic fractionation factor, default set at 3.4
#'
#' @return A dataframe of columns sitename, d13C, d15N, species, id, and tp
#'
#' @seealso \code{\link{base_sig}}
#' @seealso \code{\link{fcl_calc}}
#' @seealso \code{\link{plot_web}}

mussurl <- "https://raw.githubusercontent.com/erarsena/Arsenault_dcei/master/UnitTesting_HW/muss.csv"
muss <- RCurl::getURL(mussurl)
muss <- na.omit(read.csv(textConnection(muss)))

fishurl <- "https://raw.githubusercontent.com/erarsena/Arsenault_dcei/master/UnitTesting_HW/fish.csv"
fish <- RCurl::getURL(fishurl)
fish <- na.omit(read.csv(textConnection(fish)))

base <- base_sig(muss, 3.4)
tp_calc <- function(base, fish, frac=3.4){
  df <- merge(base, fish, by.x = "site", by.y = "site")
  df$tp <- ((((df$d15N-df$baseline))/frac)+1)
  tpdf <- data.frame(df$site, df$d13C, df$d15N, df$species, df$id, df$tp)
  colnames(tpdf) <- c("site", "d13C", "d15N", "species", "id", "tp")
  return(tpdf)
}
